{
  byte[] data="{foo}".getBytes();
  TProtocolFactory factory=TProtocolUtil.guessProtocolFactory(data,new TCompactProtocol.Factory());
  assertTrue(factory instanceof TJSONProtocol.Factory);
  GuessProtocolStruct s=new GuessProtocolStruct();
  s.putToMap_field("}","}");
  byte[] ser=new TSerializer(new TCompactProtocol.Factory()).serialize(s);
  factory=TProtocolUtil.guessProtocolFactory(ser,new TCompactProtocol.Factory());
  assertFalse(factory instanceof TJSONProtocol.Factory);
}
