{
  InputStream inputStream=getDataStream(path);
  if (inputStream == null) {
    throw new IOException("Can't open " + path);
  }
  DataInputStream dis=new DataInputStream(new BufferedInputStream(inputStream));
  String id=readWord(dis);
  if (!id.equals("s3")) {
    throw new IOException("Not proper s3 binary file " + path);
  }
  String name;
  while ((name=readWord(dis)) != null) {
    if (!name.equals("endhdr")) {
      String value=readWord(dis);
      props.setProperty(name,value);
    }
 else {
      break;
    }
  }
  int byteOrderMagic=dis.readInt();
  if (byteOrderMagic == BYTE_ORDER_MAGIC) {
    logger.fine("Not swapping " + path);
    swap=false;
  }
 else   if (Utilities.swapInteger(byteOrderMagic) == BYTE_ORDER_MAGIC) {
    logger.fine("Swapping  " + path);
    swap=true;
  }
 else {
    throw new IOException("Corrupted S3 file " + path);
  }
  return dis;
}
