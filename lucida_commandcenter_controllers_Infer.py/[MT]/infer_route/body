@infer.route('/infer', methods=['GET', 'POST'])
@login_required
def infer_route():
    result = None
    try:
        if (request.method == 'POST'):
            if (not ('op' in request.form)):
                abort(404)
            elif (request.form['op'] == 'infer'):
                services_needed = query_classifier.predict(request.form['speech_input'], request.files['file'])
                result = thrift_client.infer(session['username'], services_needed, request.form['speech_input'], request.files['file'].read())
                log(('Result ' + result))
            else:
                abort(404)
    except Exception as e:
        log(e)
        return render_template('infer.html', error=e)
    return render_template('infer.html', result=result)
