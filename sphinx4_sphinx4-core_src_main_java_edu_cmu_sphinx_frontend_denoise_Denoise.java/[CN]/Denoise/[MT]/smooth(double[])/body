{
  double[] result=new double[gain.length];
  for (int i=0; i < gain.length; i++) {
    int start=Math.max(i - smoothWindow,0);
    int end=Math.min(i + smoothWindow + 1,gain.length);
    double sum=0.0;
    for (int j=start; j < end; j++) {
      sum+=gain[j];
    }
    result[i]=sum / (end - start);
  }
  return result;
}
