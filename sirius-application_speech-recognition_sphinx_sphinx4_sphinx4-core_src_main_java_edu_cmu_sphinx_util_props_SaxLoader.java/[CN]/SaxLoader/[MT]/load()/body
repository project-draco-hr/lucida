{
  try {
    SAXParserFactory factory=SAXParserFactory.newInstance();
    XMLReader xr=factory.newSAXParser().getXMLReader();
    ConfigHandler handler=new ConfigHandler(rpdMap,globalProperties,replaceDuplicates,url);
    xr.setContentHandler(handler);
    xr.parse(url.toString());
  }
 catch (  SAXParseException e) {
    String msg="Error while parsing line " + e.getLineNumber() + " of "+ url+ ": "+ e.getMessage();
    throw new IOException(msg);
  }
catch (  SAXException e) {
    throw new IOException("Problem with XML: " + e);
  }
catch (  ParserConfigurationException e) {
    throw new IOException(e.getMessage());
  }
  return rpdMap;
}
