import re
import sys
if (__name__ == '__main__'):
    import optparse
    fi = sys.stdin
    fo = sys.stdout
    parser = optparse.OptionParser(usage='usage: %prog <template>\nThis utility reads a data set from STDIN, applies feature templates compatible\nwith CRF++, and outputs attributes to STDOUT. Each line of a data set must\nconsist of field values separated by SEPARATOR characters (customizable with\n-s option).')
    parser.add_option('-s', dest='separator', default='\t', help='specify the separator of columns of input data [default: "\\t"]')
    (options, args) = parser.parse_args()
    F = FeatureExtractor()
    F.read(open(args[0]))
    for inst in readiter(fi, options.separator):
        for t in range(len(inst)):
            F.apply(inst, t)
            fo.write(('%s' % inst[t]['y']))
            for attr in inst[t]['F']:
                fo.write(('\t%s' % attr.replace(':', '__COLON__')))
            fo.write('\n')
        fo.write('\n')
