def get_service(self, name):
    try:
        (host, port) = self.SERVICES[name][0]
        self.SERVICES[name].pop(0)
        self.SERVICES[name].append((host, port))
        tcp_addr = os.environ.get((((name + '_PORT_') + str(port)) + '_TCP_ADDR'))
        if tcp_addr:
            log(('TCP address is resolved to ' + tcp_addr))
            host = tcp_addr
        else:
            host = 'localhost'
        return (host, port)
    except Exception:
        raise RuntimeError(('Cannot access service ' + name))
