{
  Collection<String> undefProps=new ArrayList<String>();
  for (  String propName : getRegisteredProperties()) {
    Annotation anno=registeredProperties.get(propName).getAnnotation();
    boolean isMandatory=false;
    if (anno instanceof S4Component) {
      isMandatory=((S4Component)anno).mandatory() && ((S4Component)anno).defaultClass() == null;
    }
 else     if (anno instanceof S4String) {
      isMandatory=((S4String)anno).mandatory() && ((S4String)anno).defaultValue().equals(S4String.NOT_DEFINED);
    }
 else     if (anno instanceof S4Integer) {
      isMandatory=((S4Integer)anno).mandatory() && ((S4Integer)anno).defaultValue() == S4Integer.NOT_DEFINED;
    }
 else     if (anno instanceof S4Double) {
      isMandatory=((S4Double)anno).mandatory() && ((S4Double)anno).defaultValue() == S4Double.NOT_DEFINED;
    }
    if (isMandatory && !((rawProps.get(propName) != null) || (propValues.get(propName) != null)))     undefProps.add(propName);
  }
  return undefProps;
}
