{
  for (  Node node : sortedNodes) {
    int slot=findMostOverlappingSlot(node);
    Cluster targetCluster=getCluster(slot);
    if (!containsAncestor(targetCluster,node)) {
      targetCluster.add(node);
    }
 else {
      Cluster newCluster=new Cluster(node);
      int newTime=(targetCluster.startTime + targetCluster.endTime) / 2;
      targetCluster.endTime=newTime;
      newCluster.startTime=newTime;
      clusters.add(slot + 1,newCluster);
    }
  }
  return sausageFromClusters(clusters);
}
