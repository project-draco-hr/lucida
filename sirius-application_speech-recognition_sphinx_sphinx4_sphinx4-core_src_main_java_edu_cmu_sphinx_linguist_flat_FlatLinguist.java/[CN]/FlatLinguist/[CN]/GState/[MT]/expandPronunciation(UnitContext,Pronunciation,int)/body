{
  UnitContext startingContext=getStartingContext(pronunciation);
  String pname="P(" + pronunciation.getWord() + '['+ leftContext+ ','+ startingContext+ "])-G"+ getNode().getID();
  PronunciationState ps=new PronunciationState(pname,pronunciation,which);
  T("     Expanding " + ps.getPronunciation() + " for lc "+ leftContext);
  ContextPair cp=ContextPair.get(leftContext,startingContext);
  List<SearchState> epList=entryPoints.get(cp);
  if (epList == null) {
    throw new Error("No EP list for context pair " + cp);
  }
 else {
    epList.add(ps);
  }
  Unit[] units=pronunciation.getUnits();
  int fanOutPoint=units.length - getRightContextSize();
  if (fanOutPoint < 0) {
    fanOutPoint=0;
  }
  SentenceHMMState tail=ps;
  for (int i=0; tail != null && i < fanOutPoint; i++) {
    tail=attachUnit(ps,tail,units,i,leftContext,UnitContext.EMPTY);
  }
  SentenceHMMState branchTail=tail;
  for (  UnitContext finalRightContext : rightContexts) {
    tail=branchTail;
    for (int i=fanOutPoint; tail != null && i < units.length; i++) {
      tail=attachUnit(ps,tail,units,i,leftContext,finalRightContext);
    }
  }
}
