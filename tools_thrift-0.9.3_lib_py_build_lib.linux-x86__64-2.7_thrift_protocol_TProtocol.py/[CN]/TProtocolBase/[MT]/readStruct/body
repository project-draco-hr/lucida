def readStruct(self, obj, thrift_spec):
    self.readStructBegin()
    while True:
        (fname, ftype, fid) = self.readFieldBegin()
        if (ftype == TType.STOP):
            break
        try:
            field = thrift_spec[fid]
        except IndexError:
            self.skip(ftype)
        else:
            if ((field is not None) and (ftype == field[1])):
                fname = field[2]
                fspec = field[3]
                val = self.readFieldByTType(ftype, fspec)
                setattr(obj, fname, val)
            else:
                self.skip(ftype)
        self.readFieldEnd()
    self.readStructEnd()
