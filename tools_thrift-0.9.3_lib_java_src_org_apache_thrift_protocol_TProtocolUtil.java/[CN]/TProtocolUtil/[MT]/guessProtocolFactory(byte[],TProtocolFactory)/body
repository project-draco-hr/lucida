{
  if ('{' == data[0] && '}' == data[data.length - 1]) {
    return new TJSONProtocol.Factory();
  }
  if (data[data.length - 1] != 0) {
    return new TBinaryProtocol.Factory();
  }
  if (data[0] > 0x10) {
    return new TCompactProtocol.Factory();
  }
  if (data.length > 1 && 0 == data[1]) {
    return new TBinaryProtocol.Factory();
  }
  if (data.length > 1 && (data[1] & 0x80) != 0) {
    return new TCompactProtocol.Factory();
  }
  return fallback;
}
