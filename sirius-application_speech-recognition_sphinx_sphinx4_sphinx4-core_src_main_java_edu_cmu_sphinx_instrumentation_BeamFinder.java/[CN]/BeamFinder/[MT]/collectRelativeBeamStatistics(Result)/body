{
  Token token=result.getBestToken();
  int count=0;
  double sumBeam=0.0;
  maxRelativeBeam=-Float.MAX_VALUE;
  while (token != null) {
    if (token.isEmitting()) {
      TokenRank rank=(TokenRank)token.getTokenProps().get(TOKEN_RANK);
      if (rank != null) {
        if (rank.getRelativeRank() > maxRelativeBeam) {
          maxRelativeBeam=rank.getRelativeRank();
        }
        sumBeam+=rank.getRelativeRank();
        count++;
      }
 else {
        if (token.getFrameNumber() > 0) {
          System.out.println("Null rank! for " + token);
        }
      }
    }
    token=token.getPredecessor();
  }
  if (count > 0) {
    avgRelativeBeam=(float)(sumBeam / count);
    if (maxRelativeBeam > totMaxRelativeBeam) {
      totMaxRelativeBeam=maxRelativeBeam;
    }
    sumRelativeBeam+=avgRelativeBeam;
  }
}
