{
  int got=0;
  int ret=0;
  while (got < len) {
    ret=read(buf,off + got,len - got);
    if (ret <= 0) {
      throw new TTransportException("Cannot read. Remote side has closed. Tried to read " + len + " bytes, but only got "+ got+ " bytes.");
    }
    got+=ret;
  }
  return got;
}
