{
  if (format.equals(ZIP_FILE)) {
    System.out.println("WARNING: overwriting ZIP or JAR file!");
    return StreamFactory.getOutputStream(StreamFactory.resolve(location),location,file,false);
  }
 else   if (format.equals(DIRECTORY)) {
    return StreamFactory.getOutputStream(StreamFactory.DIRECTORY,location,file,false);
  }
 else {
    throw new IOException("Format not supported for writing");
  }
}
