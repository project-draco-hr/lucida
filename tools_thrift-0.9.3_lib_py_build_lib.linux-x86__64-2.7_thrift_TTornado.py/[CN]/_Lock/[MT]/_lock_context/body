@contextmanager
def _lock_context(self):
    try:
        yield
    finally:
        self.release()
