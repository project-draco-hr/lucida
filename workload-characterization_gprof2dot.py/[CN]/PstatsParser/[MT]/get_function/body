def get_function(self, key):
    try:
        id = self.function_ids[key]
    except KeyError:
        id = len(self.function_ids)
        name = self.get_function_name(key)
        function = Function(id, name)
        self.profile.functions[id] = function
        self.function_ids[key] = id
    else:
        function = self.profile.functions[id]
    return function
