import crfsuite
import sys
if (__name__ == '__main__'):
    fi = sys.stdin
    fo = sys.stdout
    tagger = crfsuite.Tagger()
    tagger.open(sys.argv[1])
    for xseq in instances(fi):
        tagger.set(xseq)
        yseq = tagger.viterbi()
        print tagger.probability(yseq)
        for (t, y) in enumerate(yseq):
            print ('%s:%f' % (y, tagger.marginal(y, t)))
        print 
